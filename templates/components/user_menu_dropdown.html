{% load i18n static %}

{% if user.is_authenticated %}
  <!-- Logged in user menu -->
  <div class="user-menu-section">
    <div class="user-profile">
      <div class="user-avatar">
        <svg viewBox="0 0 24 24" width="32" height="32" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="7" r="4"/>
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
        </svg>
      </div>
      <div class="user-info">
        <span class="user-name">{{ user.first_name|default:user.username }}</span>
        {% if user.email %}
          <span class="user-email">{{ user.email }}</span>
        {% endif %}
      </div>
    </div>
    
    <div class="menu-divider"></div>
    
    <a href="{% url 'profile' %}" class="dropdown-menu-item">
      <div class="dropdown-item-icon">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
      </div>
      <span>{% trans 'Profil' %}</span>
    </a>
    
    <a href="{% url 'accounts:addresses' %}" class="dropdown-menu-item">
      <div class="dropdown-item-icon">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
          <circle cx="12" cy="10" r="3"/>
        </svg>
      </div>
      <span>{% trans 'Adresy' %}</span>
    </a>
    
    <div class="menu-divider"></div>
    
    <button id="theme-toggle-dropdown" class="dropdown-menu-item theme-toggle-dropdown">
      <div class="dropdown-item-icon">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
      </div>
      <span>{% trans 'Tryb ciemny' %}</span>
    </button>
    
    <a href="{% url 'logout' %}" 
       class="dropdown-menu-item logout-btn" 
       hx-get="{% url 'logout' %}"
       hx-target="#user-menu-dropdown"
       hx-swap="innerHTML"
       hx-indicator="#loading-indicator">
      <div class="dropdown-item-icon">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16,17 21,12 16,7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
      </div>
      <span>{% trans 'Wyloguj się' %}</span>
    </a>
  </div>
{% else %}
  <!-- Not logged in user menu -->
  <div class="user-menu-section">
    <h3>{% trans 'Witaj!' %}</h3>
    <p>{% trans 'Zaloguj się aby uzyskać dostęp do swojego konta' %}</p>
    
    <div class="menu-actions">
      <a href="{% url 'login' %}" class="dropdown-menu-item login-btn">
        <div class="dropdown-item-icon">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
            <polyline points="10,17 15,12 10,7"/>
            <line x1="15" y1="12" x2="3" y2="12"/>
          </svg>
        </div>
        <span>{% trans 'Logowanie' %}</span>
      </a>
      
      <a href="{% url 'register' %}" class="dropdown-menu-item register-btn">
        <div class="dropdown-item-icon">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
            <circle cx="8.5" cy="7" r="4"/>
            <line x1="20" y1="8" x2="20" y2="14"/>
            <line x1="23" y1="11" x2="17" y2="11"/>
          </svg>
        </div>
        <span>{% trans 'Rejestracja' %}</span>
      </a>
    </div>
    
    <div class="menu-divider"></div>
    
    <button id="theme-toggle-dropdown" class="dropdown-menu-item theme-toggle-dropdown">
      <div class="dropdown-item-icon">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
        </svg>
      </div>
      <span>{% trans 'Tryb ciemny' %}</span>
    </button>
  </div>
{% endif %}
