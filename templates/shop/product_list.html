{% extends 'base.html' %}
{% load i18n static %}

{% block content %}
<div class="main-container">
    <h1 class="shop-title">{% trans 'Shop' %}</h1>
    <form method="get" action="" class="category-filter-form">
        <label for="category-select">{% trans 'Category' %}:</label>
        <select name="kategoria" id="category-select" onchange="this.form.submit()">
            <option value="">{% trans 'All' %}</option>
            {% for cat in categories %}
                <option value="{{ cat.slug }}" {% if category and cat == category %}selected{% endif %}>{{ cat.name }}</option>
            {% endfor %}
        </select>
        <input type="hidden" name="view" id="view-mode-input" value="{{ request.GET.view|default:'grid' }}">
        <noscript><button type="submit">{% trans 'Filter' %}</button></noscript>
    </form>
    
    <div id="product-list-container" data-view="{{ request.GET.view|default:'grid' }}">
        {% if page_obj.paginator.num_pages > 1 %}
            {% include 'shop/pagination_bar.html' %}
        {% endif %}
        <div id="product-list" class="product-list-grid product-grid">
            {% for product in products %}
            <div class="product-card product-row">
                <a href="{% url 'shop:public_product_detail' product.slug %}" class="product-link">
                    {% if product.image %}
                        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="product-image" />
                    {% else %}
                        <div class="no-image">{% trans 'No image' %}</div>
                    {% endif %}
                    <span class="product-info">
                      <h2 class="product-title">{{ product.name }}</h2>
                      <span class="product-price">
                        {% if product.discount_price %}
                            <span class="old-price">{{ product.price }} zł</span>
                            <span class="discount-price">{{ product.discount_price }} zł</span>
                        {% else %}
                            {{ product.price }} zł
                        {% endif %}
                      </span>
                    </span>
                </a>
            </div>
            {% empty %}
            <div class="no-products">{% trans 'No products found.' %}</div>
            {% endfor %}
        </div>
        {% if page_obj.paginator.num_pages > 1 %}
            {% include 'shop/pagination_bar.html' %}
        {% endif %}
    </div>
</div>
{% endblock %} 