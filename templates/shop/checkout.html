{% extends 'base.html' %}
{% load i18n %}
{% block content %}
<h1>{% trans 'Checkout' %}</h1>
{% if error %}<div class="alert alert-danger">{{ error }}</div>{% endif %}
<form method="post" novalidate>
  {% csrf_token %}
  <fieldset>
    <legend>{% trans 'Shipping & Billing Address' %}</legend>
    <div><label>{% trans 'Full name' %}*<br><input type="text" name="name" required value="{{ request.POST.name|default:'' }}"></label></div>
    <div><label>{% trans 'Street' %}*<br><input type="text" name="street" required value="{{ request.POST.street|default:'' }}"></label></div>
    <div><label>{% trans 'City' %}*<br><input type="text" name="city" required value="{{ request.POST.city|default:'' }}"></label></div>
    <div><label>{% trans 'Postcode' %}*<br><input type="text" name="postcode" required value="{{ request.POST.postcode|default:'' }}"></label></div>
    <div><label>{% trans 'Country' %}*<br><input type="text" name="country" required value="{{ request.POST.country|default:'' }}"></label></div>
    <div><label>{% trans 'Phone' %}*<br><input type="text" name="phone" required value="{{ request.POST.phone|default:'' }}"></label></div>
  </fieldset>
  <fieldset>
    <legend>{% trans 'Shipping Method' %}</legend>
    {% for method in shipping_methods %}
      <div><label><input type="radio" name="shipping_method" value="{{ method.id }}" {% if request.POST.shipping_method == method.id|stringformat:'s' %}checked{% endif %} required> {{ method.name }} ({{ method.price }} PLN)</label></div>
    {% empty %}<div>{% trans 'No shipping methods available.' %}</div>{% endfor %}
  </fieldset>
  <fieldset>
    <legend>{% trans 'Payment Method' %}</legend>
    {% for method in payment_methods %}
      <div><label><input type="radio" name="payment_method" value="{{ method.id }}" {% if request.POST.payment_method == method.id|stringformat:'s' %}checked{% endif %} required> {{ method.name }}</label></div>
    {% empty %}<div>{% trans 'No payment methods available.' %}</div>{% endfor %}
  </fieldset>
  <fieldset>
    <legend>{% trans 'Order Summary' %}</legend>
    <table class="table">
      <thead><tr><th>{% trans 'Product' %}</th><th>{% trans 'Qty' %}</th><th>{% trans 'Price' %}</th><th>{% trans 'Subtotal' %}</th></tr></thead>
      <tbody>
        {% for item in cart_items %}
        <tr>
          <td>{{ item.product.name }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.price }} PLN</td>
          <td>{{ item.subtotal }} PLN</td>
        </tr>
        {% endfor %}
      </tbody>
      <tfoot><tr><th colspan="3">{% trans 'Total' %}</th><th>{{ total }} PLN</th></tr></tfoot>
    </table>
  </fieldset>
  <button type="submit" class="btn btn-primary">{% trans 'Place Order' %}</button>
</form>
{% endblock %} 